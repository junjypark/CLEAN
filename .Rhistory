mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coup = rep(NA, n)
for (i in 1:n){
coup[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coup~x+z))[[4]][2,4]
print(sim)
}
mean(pv<0.05)
hist(pv)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3)#+0.2*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coup = rep(NA, n)
for (i in 1:n){
coup[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coup~x+z))[[4]][2,4]
print(sim)
}
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.00000001*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coup = rep(NA, n)
for (i in 1:n){
coup[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coup~x+z))[[4]][2,4]
print(sim)
}
hist(pv)
mean(pv<0.05)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+1e-15*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coup = rep(NA, n)
for (i in 1:n){
coup[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coup~x+z))[[4]][2,4]
print(sim)
}
mean(pv<0.05)
hist(pv)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coup = rep(NA, n)
for (i in 1:n){
coup[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coup~x+z))[[4]][2,4]
print(sim)
}
mean(pv<0.05)
hist(pv)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
hist(Pv)
hist(pv)
library(MASS)
n=100
p=1
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
# mod1=cbind(mod1, matrix(rnorm(n*30),n))
# mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
library(MASS)
n=100
p=2
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
# mod1=cbind(mod1, matrix(rnorm(n*30),n))
# mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
hist(pv)
cor(1:2, rnorm(2))
coupling
library(MASS)
n=100
p=5
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
# mod1=cbind(mod1, matrix(rnorm(n*30),n))
# mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
coupling
hist(copuling)
plot(coupling, z)
cor(coupling, z)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
hist(pv)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
# mod1=cbind(mod1, matrix(rnorm(n*30),n))
# mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
hist(pv)
hist(pv)
mean(pv<0.05)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5#0.5*x^2+z^2
fv2 = 0.5#3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = rep(0.5,n)#0.5*x^2+z^2
fv2 = rep(0.5,n)#3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
hist(pv)
hist(pv<0.05)
hist(pv)
mean(pv<0.05)
library(MASS)
n=100
p=3
x=rnorm(n)
z=x*0.5+rnorm(n)
fm1 = 3+x*5+z*2
fm2 = 3+x*-2+z
fv1 = 0.5*x^2+z^2
fv2 = 3*exp(x)+0.5*z^2
fc = tanh(0.3+0.1*z)
pv=vector()
for (sim in 1:1000){
mod1=matrix(NA, n,p)
mod2=matrix(NA, n,p)
for (i in 1:n){
mn= c(fm1[i], fm2[i])
varr1 = fv1[i]
varr2 = fv2[i]
corr = fc[i]
covv = matrix(c(varr1, corr*sqrt(varr1)*sqrt(varr2),
corr*sqrt(varr1)*sqrt(varr2), varr2),
2,2)
dat=mvrnorm(n=p, mu = mn, Sigma = covv)
mod1[i,]=dat[,1]
mod2[i,]=dat[,2]
}
mod1=cbind(mod1, matrix(rnorm(n*30),n))
mod2=cbind(mod2, matrix(rnorm(n*30),n))
coupling = rep(NA, n)
for (i in 1:n){
coupling[i]=cor(mod1[i,],mod2[i,])
}
pv[sim] = summary(lm(coupling~x+z))[[4]][2,4]
print(sim)
}
hist(pv)
mean(pv<0.05)
hist(pv)
2/(2*sqrt(2*log(2)))
15/(2*sqrt(2*log(2)))
5/(2*sqrt(2*log(2)))
dnorm(15, sd=15/(2*sqrt(2*log(2))))
dnorm(0, sd=15/(2*sqrt(2*log(2))))
dnorm(0, sd=10/(2*sqrt(2*log(2))))
dnorm(10, sd=10/(2*sqrt(2*log(2))))
library(devtools)
install_github("junjypark/CLEAN")
setwd("/Users/junyoungpark/Dropbox/Rpackages/CLEAN/CLEAN")
library(Rcpp)
